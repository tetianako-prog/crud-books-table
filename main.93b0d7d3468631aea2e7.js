(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{Kx2E:function(t,e,n){var a=n("mp5j");t.exports=(a.default||a).template({1:function(t,e,n,a,l){var o,i=null!=e?e:t.nullContext||{},r=t.hooks.helperMissing,d="function",u=t.escapeExpression,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"<tr data-index="+u(typeof(o=null!=(o=c(n,"idx")||(null!=e?c(e,"idx"):e))?o:r)===d?o.call(i,{name:"idx",hash:{},data:l,loc:{start:{line:2,column:15},end:{line:2,column:22}}}):o)+'>\r\n  <th scope="row">'+u(typeof(o=null!=(o=c(n,"idx")||(null!=e?c(e,"idx"):e))?o:r)===d?o.call(i,{name:"idx",hash:{},data:l,loc:{start:{line:3,column:18},end:{line:3,column:25}}}):o)+'</th>\r\n  <td><input type="text" value="'+u(typeof(o=null!=(o=c(n,"title")||(null!=e?c(e,"title"):e))?o:r)===d?o.call(i,{name:"title",hash:{},data:l,loc:{start:{line:4,column:32},end:{line:4,column:41}}}):o)+'" class="title-input" disabled /></td>\r\n  <td><input type="text" value="'+u(typeof(o=null!=(o=c(n,"author")||(null!=e?c(e,"author"):e))?o:r)===d?o.call(i,{name:"author",hash:{},data:l,loc:{start:{line:5,column:32},end:{line:5,column:42}}}):o)+'" disabled /></td>\r\n  <td><input type="text" value="'+u(typeof(o=null!=(o=c(n,"genre")||(null!=e?c(e,"genre"):e))?o:r)===d?o.call(i,{name:"genre",hash:{},data:l,loc:{start:{line:6,column:32},end:{line:6,column:41}}}):o)+'" disabled /></td>\r\n  <td><input type="text" value="'+u(typeof(o=null!=(o=c(n,"rating")||(null!=e?c(e,"rating"):e))?o:r)===d?o.call(i,{name:"rating",hash:{},data:l,loc:{start:{line:7,column:32},end:{line:7,column:42}}}):o)+'" disabled /></td>\r\n  <td><button data-id='+u(typeof(o=null!=(o=c(n,"id")||(null!=e?c(e,"id"):e))?o:r)===d?o.call(i,{name:"id",hash:{},data:l,loc:{start:{line:8,column:22},end:{line:8,column:28}}}):o)+' type="button" class="btn btn-danger remove-btn">Удалить</button></td>\r\n  <td><button data-id='+u(typeof(o=null!=(o=c(n,"id")||(null!=e?c(e,"id"):e))?o:r)===d?o.call(i,{name:"id",hash:{},data:l,loc:{start:{line:9,column:22},end:{line:9,column:28}}}):o)+" data-idx="+u(typeof(o=null!=(o=c(n,"idx")||(null!=e?c(e,"idx"):e))?o:r)===d?o.call(i,{name:"idx",hash:{},data:l,loc:{start:{line:9,column:38},end:{line:9,column:45}}}):o)+' type="button" class="btn btn-primary edit-btn">Редактировать</button></td>\r\n</tr>\r\n'},compiler:[8,">= 4.3.0"],main:function(t,e,n,a,l){var o;return null!=(o=(t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]})(n,"each").call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l,loc:{start:{line:1,column:0},end:{line:11,column:9}}}))?o:""},useData:!0})},L1EO:function(t,e,n){},QfWi:function(t,e,n){"use strict";n.r(e);n("L1EO"),n("JBxO"),n("FdtR");var a={getBooks:function(){return fetch("https://605f8a7104b05d0017ba1757.mockapi.io/books").then((function(t){return t.json()})).catch((function(t){return console.log(t)}))},addBook:function(t){return fetch("https://605f8a7104b05d0017ba1757.mockapi.io/books",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=UTF-8"}})},deleteBook:function(t){return fetch("https://605f8a7104b05d0017ba1757.mockapi.io/books/"+t,{method:"DELETE"})},updateBook:function(t,e){return fetch("https://605f8a7104b05d0017ba1757.mockapi.io/books/"+t,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"}})}},l=(n("lmye"),n("wCa+"),n("Kx2E")),o=n.n(l),i={container:document.querySelector(".container"),table:document.querySelector("table"),addButton:document.querySelector(".add"),spinner:document.querySelector(".add > .spinner"),addBtnLabel:document.querySelector(".add-label")};var r=function(t){var e=t.map((function(t,e){return Object.assign({},t,{idx:e+1})})),n=o()(e);i.container.innerHTML="",i.container.insertAdjacentHTML("beforeend",n)},d=n("rsPG"),u=n.n(d);var c=function(t){return{title:t.children[1].firstChild.value,author:t.children[2].firstChild.value,genre:t.children[3].firstChild.value,rating:t.children[4].firstChild.value}};var s=function(t){if(""===t.children[1].firstChild.value||""===t.children[2].firstChild.value||""===t.children[3].firstChild.value||""===t.children[4].firstChild.value)return!0};a.getBooks().then(r);var h=!1;i.addButton.addEventListener("click",(function(){if(h){var t=document.querySelector(".new-row");if(s(t))return void alert("Заполните все поля");i.addButton.disabled=!0,i.addBtnLabel.textContent="Добавляем",i.spinner.classList.remove("is-hidden"),a.addBook(c(t)).then((function(t){t.ok&&a.getBooks().then(r),i.addButton.disabled=!1,h=!1,i.addBtnLabel.textContent="Добавить",i.spinner.classList.add("is-hidden")})).catch((function(t){return console.log(t)}))}else{h=!0,i.addBtnLabel.textContent="Cохранить";var e=u()();i.container.insertAdjacentHTML("beforeend",e)}}));var p=!1;i.table.addEventListener("click",(function(t){if("BUTTON"===t.target.nodeName){if(t.target.classList.contains("remove-btn")){var e=t.target.dataset.id;t.target.disabled=!0,t.target.textContent="Удаляем",a.deleteBook(e).then((function(t){t.ok&&a.getBooks().then(r)})).catch((function(t){return console.log(t)}))}if(t.target.classList.contains("edit-btn")){var n=t.target.dataset.idx,l=t.target.dataset.id,o=document.querySelector('[data-index="'+n+'"]');if(p){if(s(o))return void alert("Заполните все поля");t.target.disabled=!0,t.target.textContent="Сохраняем",a.updateBook(l,c(o)).then((function(e){e.ok&&a.getBooks().then(r),p=!1,t.target.disabled=!1,t.target.textContent="Редактировать"})).catch((function(t){return console.log(t)}))}else{for(var i=1;i<5;i+=1)o.children[i].firstChild.disabled=!1;t.target.textContent="Сохранить",p=!0}}}}))},rsPG:function(t,e,n){var a=n("mp5j");t.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(t,e,n,a,l){return'<tr class="new-row">\r\n  <td></td>\r\n  <td><input type="text" value="" /></td>\r\n  <td><input type="text" value="" /></td>\r\n  <td><input type="text" value="" /></td>\r\n  <td><input type="text" value="" /></td>\r\n</tr>'},useData:!0})}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.93b0d7d3468631aea2e7.js.map